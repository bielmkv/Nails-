<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nails By Suzan Santos</title>
    <link rel="icon" type="image/jpg" href="img/favicon.ico">

    <!-- Fontes -->
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600;700;900&display=swap" rel="stylesheet">

    <!-- CSS externo -->
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <header class="logo-header">
        <h1 class="logo-nails">Nails</h1>
        <p class="logo-by">BY SUZAN SANTOS</p>
        <p>Agende seu hor√°rio e veja nosso portf√≥lio!</p>
    </header>

    <nav>
        <a href="portifolio.html">PORT√çFOLIO</a>
        <a href="#agendamento">AGENDAR HOR√ÅRIO</a>
        <a href="https://wa.me/5513997305044?text= agendamento">CONTATO: (13) 99730-5044</a>
    </nav>

    <section class="info-section">
        <div class="info-box">
            <h3>SOBRE MIM</h3>
            <div class="divider"></div>
            <p>Ol√°, amigas! Me chamo Suzan, sou Nail Designer apaixonada por cuidar das suas unhas com delicadeza e qualidade. Meu objetivo √© oferecer um atendimento acolhedor e resultados duradouros.
Ser√° um prazer cuidar¬†de¬†voc√™!¬†‚ú®</p>
        </div>

        <div class="info-box">
            <h3>POL√çTICAS</h3>
            <div class="divider"></div>
            <p>‚Ä¢ Toler√¢ncia m√°xima de 10 minutos de atraso.<br>
‚Ä¢ Cancelamento ou reagendamento com no m√≠nimo 12h de anteced√™ncia.<br>
‚Ä¢ Hor√°rios s√£o reservados exclusivamente para¬†cada¬†cliente.</p>
        </div>
    </section>

    <section id="agendamento">
        <div class="button-group">
            <button id="btnSessao">Agendar Aplica√ß√£o</button>
            <button id="btnManutencao">Agendar Manuten√ß√£o</button>
        </div>

        <div id="formSessao" class="form-container active">
            <h3>Agendar Aplica√ß√£o</h3>
            <form id="appointmentForm">
                <label for="name">Nome:</label>
                <input type="text" name="name" id="name" required>

                <label for="phone">Telefone:</label>
                <input type="tel" name="phone" id="phone" required>

                <label for="date">Data:</label>
                <select name="date" id="date" required>
                    <option value="">Selecione</option>
                </select>

                <label for="time">Hor√°rio:</label>
                <select name="time" id="time" required>
                    <option value="">Selecione</option>
                </select>

                <label for="service">Servi√ßo:</label>
                <select name="service" id="service" required>
                    <option value="">Selecione</option>
                    <option value="Banho De Gel">Banho De Gel</option>
                    <option value="Gel Na Tips">Gel Na Tips</option>
                </select>

                <button type="submit">Agendar Aplica√ß√£o</button>
            </form>
        </div>

        <div id="formManutencao" class="form-container">
            <h3>Agendar Manuten√ß√£o</h3>
            <form id="maintenanceForm">
                <label for="nameM">Nome:</label>
                <input type="text" name="nameM" id="nameM" required>

                <label for="phoneM">Telefone:</label>
                <input type="tel" name="phoneM" id="phoneM" required>

                <label for="lastDate">Data da √öltima Aplica√ß√£o:</label>
                <input type="date" name="lastDate" id="lastDate" required>

                <label for="dateM">Data Desejada:</label>
                <select name="dateM" id="dateM" required>
                    <option value="">Selecione</option>
                </select>

                <label for="timeM">Hor√°rio:</label>
                <select name="timeM" id="timeM" required>
                    <option value="">Selecione</option>
                </select>

                <label for="maintenanceType">Tipo de Manuten√ß√£o:</label>
                <select name="maintenanceType" id="maintenanceType" required>
                    <option value="">Selecione</option>
                    <option value="Banho De Gel">Banho De Gel</option>
                    <option value="Gel Na Tips">Gel Na Tips</option>
                </select>
                <button type="submit">Agendar Manuten√ß√£o</button>
            </form>
        </div>

        <p id="status"></p>
    </section>

    <footer id="contato">
        <p>&copy;  2025 Nails By Suzan Santos </p>
    </footer>

    <script type="module">
        function sendToWhatsApp(message) {
            const phone = "5513997305044";
            const url = `https://wa.me/${phone}?text=${encodeURIComponent(message)}`;
            window.open(url, "_blank");
        }

        import { getBookedTimes, saveAppointment } from "./firebase.js";

        const date = document.getElementById("date");
        const time = document.getElementById("time");
        const dateM = document.getElementById("dateM");
        const timeM = document.getElementById("timeM");
        const appointmentForm = document.getElementById("appointmentForm");
        const maintenanceForm = document.getElementById("maintenanceForm");
        const name = document.getElementById("name");
        const phone = document.getElementById("phone");
        const service = document.getElementById("service");
        const nameM = document.getElementById("nameM");
        const phoneM = document.getElementById("phoneM");
        const maintenanceType = document.getElementById("maintenanceType");

        const availableTimesPerDay = {
            sunday: [],
            monday: ['06:00','18:00'],
            tuesday: ['06:00','18:00'],
            wednesday: ['06:00','18:00'],
            thursday: ['06:00','18:00'],
            friday: ['06:00','18:00'],
            saturday: ['17:00','19:00'],
        };

        const days = ['monday','tuesday','wednesday','thursday','friday','saturday', 'sunday'];

        // üîπ Fun√ß√µes atualizadas para data local üîπ
        function generateDates() {
            const dates = [];
            const today = new Date();
            for (let i = 0; i < 30; i++) {
                const d = new Date(today);
                d.setDate(today.getDate() + i);

                // Pular domingos (getDay() === 0)
                if (d.getDay() === 0) continue;

                const year = d.getFullYear();
                const month = String(d.getMonth() + 1).padStart(2, '0');
                const day = String(d.getDate()).padStart(2, '0');

                dates.push({
                    value: `${year}-${month}-${day}`,
                    text: d.toLocaleDateString('pt-BR')
                });
            }
            return dates;
        }

        async function updateDateOptions(dateSelect, timeSelect) {
            dateSelect.innerHTML = '<option value="">Selecione</option>';
            const dates = generateDates();

            for (const date of dates) {
                const booked = await getBookedTimes(date.value);
                const day = days[new Date(date.value).getDay()];
                const available = availableTimesPerDay[day] || [];
                const free = available.filter(t => !booked[t]);

                if (free.length > 0) {
                    const option = document.createElement('option');
                    option.value = date.value;
                    option.textContent = date.text;
                    dateSelect.appendChild(option);
                }
            }
        }

        async function updateTimeOptions(dateSelect, timeSelect) {
            timeSelect.innerHTML = '<option value="">Selecione</option>';
            const date = dateSelect.value;
            if (!date) return;

            const booked = await getBookedTimes(date);
            const day = days[new Date(date).getDay()];
            const available = availableTimesPerDay[day] || [];

            available.forEach(time => {
                if (!booked[time]) {
                    const opt = document.createElement('option');
                    opt.value = time;
                    opt.textContent = time;
                    timeSelect.appendChild(opt);
                }
            });
        }

        date.addEventListener('change', () => updateTimeOptions(date, time));
        dateM.addEventListener('change', () => updateTimeOptions(dateM, timeM));

        updateDateOptions(date, time);
        updateDateOptions(dateM, timeM);

        appointmentForm.addEventListener('submit', async e => {
            e.preventDefault();
            try {
                await saveAppointment(date.value, time.value, {
                    name: name.value,
                    phone: phone.value,
                    service: service.value,
                    type: 'aplicacao'
                });

                const msg = `
‚ú® *NOVO AGENDAMENTO ‚Äì APLICA√á√ÉO* ‚ú®

üë§ Nome: ${name.value}
üìû Telefone: ${phone.value}
üìÖ Data: ${date.value}
‚è∞ Hor√°rio: ${time.value}
üíÖ Servi√ßo: ${service.value}
                `;

                sendToWhatsApp(msg);
                alert("Hor√°rio agendado com sucesso!");
                location.reload();
            } catch (err) {
                alert("Este hor√°rio j√° foi reservado.");
            }
        });

        maintenanceForm.addEventListener('submit', async e => {
            e.preventDefault();
            try {
                await saveAppointment(dateM.value, timeM.value, {
                    name: nameM.value,
                    phone: phoneM.value,
                    service: maintenanceType.value,
                    type: 'manutencao'
                });

                const msg = `
üîß *NOVO AGENDAMENTO ‚Äì MANUTEN√á√ÉO* üîß

üë§ Nome: ${nameM.value}
üìû Telefone: ${phoneM.value}
üìÖ Data desejada: ${dateM.value}
‚è∞ Hor√°rio: ${timeM.value}
üíÖ Servi√ßo: ${maintenanceType.value}
üìÜ √öltima aplica√ß√£o: ${lastDate.value}
                `;

                sendToWhatsApp(msg);
                alert("Manuten√ß√£o agendada com sucesso!");
                location.reload();
            } catch (err) {
                alert("Este hor√°rio j√° foi reservado.");
            }
        });
    </script>
</body>
</html>

















